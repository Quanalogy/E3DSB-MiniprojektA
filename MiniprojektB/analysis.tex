% !TEX root = main.tex

\section{Analysis}
% Does IIR calculate faster than FIR? Use tic/toc in math code.
% Does multiplying the IIR coefficients  exponentially increase computation time?

\subsection{Original Signal}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgFreq}
	\caption{Frequency spectrum of the non-filtered signal.}
	\label{fig:orgfreq}
\end{figure}

\subsection{Filtered Signals}
All frequency bands presented in \cref{tab:FiveBand} will be filtered using FIR. Some of them will also be filtered using IIR to test the expectations presented in \cref{sec:expectations}.

\subsubsection{FIR Frequency Spectrums}
The five \crefrange{fig:FIR_hipass}{fig:FIR_lowpass} demonstrate different kinds of FIR-filtering, which are all implemented using the matlab fir1 function. \Cref{fig:FIR_hipass} is a highpass filter with a cutoff frequency of \SI{512}{\hertz} and an order of 70. \Cref{fig:FIR_bandpass1} shows a bandpass with cutoff frequencies of \SI{512}{\hertz} and \SI{2048}{\hertz} and an order of 50. \Cref{fig:FIR_stopband} shows a stopband filter with cutoff frquencies of \SI{2048}{\hertz} and \SI{8192}{\hertz} and an order of 50. \Cref{fig:FIR_bandpass2} shows a bandpass filter with cutoff frequencies of \SI{8192}{\hertz} and \SI{16384}{\hertz} and an order of 50. The last filter, \cref{fig:FIR_lowpass} shows a lowpass filter with a cutoff frequency of \SI{16384}{\hertz} and an order of 5.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgHPFreq}
	\caption{Frequency spectrum of the non-filtered signal(red) and the highpass filtered signal(blue).}
	\label{fig:FIR_hipass}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgBP1Freq}
	\caption{Frequency spectrum of the non-filtered signal(red) and the first bandpass filtered signal(blue).}
	\label{fig:FIR_bandpass1}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgSPFreq}
	\caption{Frequency spectrum of the non-filtered signal(red) and the stopband filtered signal(blue).}
	\label{fig:FIR_stopband}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgBP3Freq}
	\caption{Frequency spectrum of the non-filtered signal(red) and the second bandpass filtered signal(blue).}
	\label{fig:FIR_bandpass2}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth]{matlab/OrgLPFreq}
	\caption{Frequency spectrum of the non-filtered signal(red) and the lowpass filtered signal(blue).}
	\label{fig:FIR_lowpass}
\end{figure}

\clearpage

\subsubsection{IIR Frequency Spectrums}
\Cref{fig:IIR_BP1highpass} and \cref{fig:IIR_BP1bandpass} shows the effect of a few IIR filters on the original frequency spectrum. \Cref{fig:IIR_BP1highpass} is a high pass filter at \SI{512}{\hertz} with an order of 1. \Cref{fig:IIR_BP1bandpass} is a bandpass filter at the frequencies \SI{512}{\hertz} and \SI{2048}{\hertz} with an order of 1.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth, clip, trim={6cm 5cm 6cm 5cm}]{matlab/OrgIIRHPFreq}sss
	\caption{Frequency spectrum of the non-filtered signal(red) a highpass IIR filtered signal(blue).}
	\label{fig:IIR_BP1highpass}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth, clip, trim={6cm 5cm 6cm 5cm}]{matlab/BP1normFreqIIR}
	\caption{Frequency spectrum of the non-filtered signal(red) a bandpass IIR filtered signal(blue).}
	\label{fig:IIR_BP1bandpass}
\end{figure}

\clearpage

\subsection{FIR - Different Window Types}
\label{sec:FIR_windows}
Here the effect (shown as impulse response) of different window types on a 50th order FIR bandpass filter will be investigated.

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth, clip, trim={3cm 9cm 4cm 10cm}]{matlab/FIR50Hamming}
	\caption{Impulse Response of using a Hamming Window.}
	\label{fig:FIR_50Hamming}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth, clip, trim={3cm 9cm 4cm 10}]{matlab/FIR50Cheby}
	\caption{Impulse Response of using a Chebyschev Window.}
	\label{fig:FIR_50Cheby}
\end{figure}

\begin{figure}[!htb]
	\centering
	\includegraphics[width=0.9\linewidth, clip, trim={3cm 9cm 4cm 10}]{matlab/FIR50Kaiser05}
	\caption{Impulse Response of using a Kaiser Window. $\beta=0.5$.}
	\label{fig:FIR_50Kaiser}
\end{figure}
